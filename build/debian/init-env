#! /bin/bash

# New User/Apt/Conda Env Initialization
# =====================================

err_exit() {
    echo "# !Error: $*"
    exit 1
}

set -e
init-apt-deps
export USER_NAME=$(init-new-user)
echo "# => Switching to user '$USER_NAME' and running: init-conda-env $* ..."
su ${USER_NAME} -p -s /bin/bash -c \
    'HOME="/home/${USER_NAME}" init-conda-env "$@"' -- "init-conda-env" "$@"
